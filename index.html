<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Black Market Pawn Shop</title>
    <style>
        :root {
            --bg-deep: #0a0a0b;
            --illegal-red: #a32a2a;
        }

        * { image-rendering: pixelated; box-sizing: border-box; font-family: 'Courier New', monospace; }
        
        body {
            margin: 0; height: 100vh;
            /* [배경 적용] 주신 전체 배경 이미지 */
            background: var(--bg-deep) url('https://github.com/bagjueun307/-/blob/main/%EC%A0%84%EC%B2%B4.png?raw=true') no-repeat center center;
            background-size: cover;
            display: flex; flex-direction: column; align-items: center;
            color: #eee; overflow: hidden;
        }

        /* 서류 UI (위치 살짝 조정) */
        .appraisal-sheet {
            position: absolute; top: 40px; left: 50%;
            transform: translateX(-50%);
            width: 480px; background: rgba(209, 209, 202, 0.9); /* 약간 투명하게 */
            border: 4px solid #111; padding: 15px; color: #111;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.6); z-index: 100;
        }

        .sheet-header { border-bottom: 2px solid #111; padding-bottom: 5px; margin-bottom: 10px; font-weight: bold; font-size: 12px; display: flex; justify-content: space-between; }
        .dialogue-text { height: 40px; font-size: 14px; font-weight: bold; margin-bottom: 10px; border-left: 4px solid var(--illegal-red); padding-left: 10px; display: flex; align-items: center; }

        .btn-group { display: flex; gap: 10px; }
        button { padding: 8px 15px; border: 3px solid #111; cursor: pointer; font-weight: bold; }
        .btn-accept { background: #4a5d4a; color: white; }
        .btn-deny { background: #8e2424; color: white; }

        /* 야바위 구역 - 이미지 속 책상 높이에 맞춤 */
        .game-zone { 
            position: absolute; 
            bottom: 22%; /* 책상 윗면 높이에 맞게 조정 */
            width: 650px; height: 150px; 
        }

        .cup {
            position: absolute; width: 100px; height: 120px;
            /* [컵 이미지 적용] */
            background: url('https://github.com/bagjueun307/-/blob/main/%EC%BB%B5%20%EC%97%8E%EC%9D%80%20%ED%98%95%ED%83%9C%20%EC%9D%B4%EB%AF%B8%EC%A7%80.png?raw=true') no-repeat center center;
            background-size: contain;
            transition: left 0.4s ease-in-out, transform 0.3s ease; 
            cursor: pointer; z-index: 2;
        }

        /* 컵이 들릴 때 이미지 교체 */
        .cup.lifted {
            background-image: url('https://github.com/bagjueun307/-/blob/main/%EC%9C%84%EB%A1%9C%20%ED%96%A5%ED%95%9C%20%EC%BB%B5%20%EC%9D%B4%EB%AF%B8%EC%A7%80.png?raw=true');
            transform: translateY(-50px);
        }

        /* 컵 그림자 (책상 위에 놓인 느낌 극대화) */
        .cup::after {
            content: ''; position: absolute; bottom: -5px; left: 10%;
            width: 80%; height: 10px; background: rgba(0,0,0,0.4);
            border-radius: 50%; z-index: -1;
        }

        .pixel-coin {
            position: absolute; bottom: 10px; width: 45px; height: 45px;
            /* [코인 이미지 적용 - 위에서 찾은 도트 코인] */
            background: url('https://raw.githubusercontent.com/SuperAuri/Pixel-Art/master/GoldCoin.png') no-repeat center center;
            background-size: contain;
            display: none; z-index: 1;
        }

        #balance-display { color: #2e7d32; font-weight: bold; }
    </style>
</head>
<body>

    <div class="appraisal-sheet">
        <div class="sheet-header">
            <span>ILLEGAL AUTHENTICATION</span>
            <span id="balance-display">WALLET: 0 COINS</span>
        </div>
        <div id="dialogue" class="dialogue-text">"물건부터 꺼내보시지. 장난질이면 총 맞을 줄 알고."</div>
        
        <div id="item-info" style="display:none; border-top: 2px dashed #111; padding: 10px 0;">
            <div style="display:flex; justify-content: space-between; font-weight: bold;">
                <span id="item-name" style="color:var(--illegal-red);"></span>
                <span id="item-val"></span>
            </div>
        </div>

        <div class="btn-group">
            <button id="btn-main" class="btn-accept" onclick="startAppraisal(false)">물건 감정</button>
            <button id="btn-re" class="btn-deny" onclick="startAppraisal(true)" style="display:none;">다른 물건</button>
        </div>
    </div>

    <div class="game-zone">
        <div id="slot-0" class="cup" style="left: 80px;" onclick="select(0)"></div>
        <div id="slot-1" class="cup" style="left: 275px;" onclick="select(1)"></div>
        <div id="slot-2" class="cup" style="left: 470px;" onclick="select(2)"></div>
        <div id="coin-actor" class="pixel-coin"></div>
    </div>

<script>
    /* 기존 스크립트 로직 동일 (이미지 경로만 연동) */
    let wallet = 0; let playing = false; let finished = true; let coinPos = 1; let currentVal = 0;

    const items = [
        { n: "장물 다이아", v: 100, m: "오... 빛깔 좋군. 이 정도면 판을 벌릴만 해." },
        { n: "밀수 금괴", v: 50, m: "묵직하군. 제대로 눈 크게 뜨고 보라고." },
        { n: "암시장 칩", v: 30, m: "정보가 가득 들었군. 어디 숨겼는지 맞춰봐." },
        { n: "명품 시계", v: 20, m: "시간이 금이지. 자, 섞는다!" },
        { n: "은수저", v: 5, m: "연습 삼아 한 번 해보자고." }
    ];

    function startAppraisal(isRetry) {
        if(playing) return;
        const diag = document.getElementById('dialogue');
        const btnMain = document.getElementById('btn-main');
        const btnRe = document.getElementById('btn-re');

        btnMain.disabled = btnRe.disabled = true;
        diag.innerText = isRetry ? "흥, 그거보다 나은 게 있다고? (감정 중...)" : "어디 보자... (장갑을 끼며)";

        setTimeout(() => {
            const item = items[Math.floor(Math.random() * items.length)];
            currentVal = item.v;
            document.getElementById('item-info').style.display = 'block';
            document.getElementById('item-name').innerText = `[${item.n}]`;
            document.getElementById('item-val').innerText = `VALUE: ${item.v}`;
            diag.innerText = `"${item.m}"`;
            btnMain.disabled = btnRe.disabled = false;
            btnMain.innerText = "야바위 수락";
            btnMain.onclick = startShuffle;
            btnRe.style.display = 'inline-block';
        }, 1000);
    }

    function startShuffle() {
        playing = true; finished = false;
        document.getElementById('btn-main').disabled = true;
        document.getElementById('btn-re').disabled = true;
        
        coinPos = Math.floor(Math.random()*3);
        const coin = document.getElementById('coin-actor');
        const cups = document.querySelectorAll('.cup');
        
        // 코인 위치 보여주기
        const targetLeft = parseInt(cups[coinPos].style.left);
        coin.style.left = (targetLeft + 28) + "px";
        cups[coinPos].classList.add('lifted');
        coin.style.display = 'block';

        setTimeout(() => {
            cups[coinPos].classList.remove('lifted');
            setTimeout(() => { 
                coin.style.display = 'none'; 
                performShuffle(0, 10, 0.4); 
            }, 500);
        }, 1200);
    }

    function performShuffle(count, total, speed) {
        if(count >= total) {
            playing = false;
            document.getElementById('dialogue').innerText = "자, 어느 쪽이지? 선택해.";
            return;
        }
        let a = Math.floor(Math.random()*3);
        let b = Math.floor(Math.random()*3);
        while(a === b) b = Math.floor(Math.random()*3);

        const cupA = document.getElementById(`slot-${a}`);
        const cupB = document.getElementById(`slot-${b}`);
        const tempLeft = cupA.style.left;
        cupA.style.left = cupB.style.left;
        cupB.style.left = tempLeft;

        if(coinPos === a) coinPos = b;
        else if(coinPos === b) coinPos = a;

        setTimeout(() => performShuffle(count + 1, total, speed), speed * 1100);
    }

    function select(id) {
        if(playing || finished) return;
        finished = true;
        const cups = document.querySelectorAll('.cup');
        const coin = document.getElementById('coin-actor');
        
        cups[id].classList.add('lifted');
        coin.style.left = (parseInt(cups[id].style.left) + 28) + "px";

        if(id === coinPos) {
            coin.style.display = 'block';
            wallet += currentVal;
            document.getElementById('dialogue').innerText = "호오, 제법인데? 여기 약속한 코인이다.";
        } else {
            document.getElementById('dialogue').innerText = "땡! 이건 내 거야. 불만 있으면 경찰을 부르든가.";
            setTimeout(() => {
                coin.style.left = (parseInt(cups[coinPos].style.left) + 28) + "px";
                coin.style.display = 'block';
                cups[coinPos].classList.add('lifted');
            }, 500);
        }

        document.getElementById('balance-display').innerText = `WALLET: ${wallet} COINS`;
        setTimeout(() => {
            document.getElementById('item-info').style.display = 'none';
            document.getElementById('btn-re').style.display = 'none';
            document.getElementById('btn-main').disabled = false;
            document.getElementById('btn-main').innerText = "다른 물건 꺼내기";
            document.getElementById('btn-main').onclick = () => startAppraisal(false);
            cups.forEach(c => c.classList.remove('lifted'));
            coin.style.display = 'none';
        }, 3000);
    }
</script>
</body>
</html>
