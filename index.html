<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Secret Pawn Shop - Pro Edition</title>
    <style>
        * { image-rendering: pixelated; box-sizing: border-box; cursor: crosshair; }
        
        body {
            margin: 0; height: 100vh;
            /* ê¹ƒí—ˆë¸Œ ì´ë¯¸ì§€ë¥¼ ì§ì ‘ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•´ raw ê²½ë¡œë¡œ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤ */
            background: #000 url('https://raw.githubusercontent.com/bagjueun307/-/main/background.png') no-repeat center center;
            background-size: cover;
            display: flex; flex-direction: column; align-items: center;
            font-family: 'Courier New', monospace; color: #eee;
            overflow: hidden;
        }

        /* ìƒë‹¨ ì§€ê°‘ */
        .top-bar { width: 100%; padding: 20px; z-index: 1000; }
        .wallet { 
            background: rgba(0,0,0,0.8); 
            border: 3px solid #5d3a1a; 
            padding: 10px 20px; 
            display: inline-block; 
            box-shadow: 4px 4px 0px #000;
        }
        
        /* ì¤‘ì•™ ê°ì • ì„¼í„° - ë°°ê²½ ì´ë¯¸ì§€ ìœ„ì—ì„œë„ ì˜ ë³´ì´ë„ë¡ ë°˜íˆ¬ëª… ì²˜ë¦¬ */
        .appraisal-center {
            width: 480px; 
            background: rgba(15, 15, 15, 0.9);
            backdrop-filter: blur(5px); /* ë°°ê²½ì„ ì‚´ì§ íë¦¬ê²Œ í•˜ì—¬ ê°€ë…ì„± í™•ë³´ */
            border: 4px solid #5d3a1a; 
            padding: 20px; 
            text-align: center;
            z-index: 100; 
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.7);
        }

        .item-visual { 
            width: 80px; height: 80px; margin: 10px auto; 
            background: #222; border: 2px solid #333; 
            display: flex; align-items: center; justify-content: center; 
        }
        .item-visual img { width: 60px; height: 60px; }

        /* ì•¼ë°”ìœ„ êµ¬ì—­ */
        .game-area { position: relative; width: 600px; height: 200px; margin-top: 40px; }
        
        #dealer-hand {
            position: absolute; width: 140px; height: 140px;
            background: url('hand.png') no-repeat center center; /* ì† ì´ë¯¸ì§€ ê²½ë¡œ */
            background-size: contain;
            z-index: 10; pointer-events: none;
            opacity: 0; transform: translateY(-30px);
        }

        .cup-slot { position: absolute; width: 100px; height: 120px; display: flex; justify-content: center; align-items: flex-end; }
        .cup-pixel { 
            width: 80px; height: 100px; 
            background: #8b5a2b; border: 4px solid #3e2712; 
            border-radius: 10px 10px 30px 30px; 
            z-index: 2; transition: transform 0.3s ease-out; position: relative; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .cup-pixel::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 8px; background: #a67c52; border-bottom: 3px solid #3e2712; }
        
        .lifted .cup-pixel { transform: translateY(-80px) rotate(-15deg); }
        .coin-stack { position: absolute; bottom: 10px; display: none; z-index: 1; }
        .coin-stack.visible { display: flex; }
        .dot-coin { width: 34px; height: 10px; background: #ffd700; border: 2px solid #b8860b; border-radius: 3px; }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-group { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
        button { 
            background: #e63946; color: white; border: none; padding: 12px 25px; 
            font-family: inherit; font-weight: bold; cursor: pointer; 
            border-bottom: 4px solid #9d2630; 
        }
        button.secondary { background: #457b9d; border-bottom-color: #1d3557; }
        button:active { border-bottom: none; transform: translateY(4px); }
        button:disabled { background: #333; color: #666; border-bottom: none; }

        #dialogue { min-height: 50px; display: flex; align-items: center; justify-content: center; font-size: 0.95rem; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="wallet">
            <span style="color:#888; font-size: 0.7rem;">PURSE:</span> 
            <span id="balance" style="color:#ffd700; font-weight: bold; font-size: 1.2rem;">0 COINS</span>
        </div>
    </div>

    <div class="appraisal-center">
        <div id="dialogue">"ê°€ì ¸ì˜¨ ë¬¼ê±´ì„ í…Œì´ë¸” ìœ„ì— ì˜¬ë ¤ë‘ê²Œ."</div>
        
        <div id="item-area" style="display:none;">
            <div class="item-visual"><img id="item-icon" src="" alt=""></div>
            <div id="item-name" style="font-size: 1.2rem; color: #4ade80; font-weight: bold;"></div>
            <div id="bet-details" style="color: #ffd700; font-size: 0.9rem; margin-top: 5px; letter-spacing: 1px;"></div>
        </div>
        
        <div class="btn-group">
            <button id="re-appraise-btn" class="secondary" onclick="appraise(true)" style="display:none;">ë‹¤ë¥¸ ë¬¼ê±´ ê°ì •</button>
            <button id="main-btn" onclick="appraise(false)">ë¬¼ê±´ êº¼ë‚´ê¸°</button>
        </div>
    </div>

    <div class="game-area">
        <div id="dealer-hand"></div>
        <div class="cup-slot" id="slot-0" style="left: 60px;" onclick="select(0)">
            <div class="cup-pixel"></div>
            <div id="coins-0" class="coin-stack"><div class="dot-coin"></div></div>
        </div>
        <div class="cup-slot" id="slot-1" style="left: 250px;" onclick="select(1)">
            <div class="cup-pixel"></div>
            <div id="coins-1" class="coin-stack"><div class="dot-coin"></div></div>
        </div>
        <div class="cup-slot" id="slot-2" style="left: 440px;" onclick="select(2)">
            <div class="cup-pixel"></div>
            <div id="coins-2" class="coin-stack"><div class="dot-coin"></div></div>
        </div>
    </div>

<script>
    let coins = 0;
    let playing = false;
    let finished = true;
    let coinPos = 1;
    let rewards = { win: 0 };
    let currentSpeed = 0.6; 

    const items = [
        { name: "ë…¹ìŠ¨ íœì¹˜", val: 1, img: "pliers.png", msg: "ì´ê±´ ê·¸ëƒ¥ ê³ ì²  ë©ì–´ë¦¬ì–ì•„?" },
        { name: "ì€ë„ê¸ˆ ë°˜ì§€", val: 2, img: "ring.png", msg: "ì€ í•¨ëŸ‰ì´ ì¡°ê¸ˆ ì•„ì‰½êµ°." },
        { name: "ë‚¡ì€ ë¡¤ë ‰ìŠ¤", val: 3, img: "rolex.png", msg: "ì˜¤í˜¸... ê´€ë¦¬ê°€ ê½¤ ì˜ëœ ë¡¤ë ‰ìŠ¤êµ°." },
        { name: "ëª…í’ˆ ê°€ì£½ ì§€ê°‘", val: 4, img: "wallet.png", msg: "ê°€ì£½ ì§ˆê°ì´ ì˜ˆìˆ ì´ì•¼. ì§‘ì¤‘í•˜ê²Œ." },
        { name: "ë‹¤ì´ì•„ëª¬ë“œ ë°˜ì§€", val: 5, img: "diamond.png", msg: "ì„¸ìƒì—! ì´ê±´ ì§„ì§œêµ°. ë‚´ ì‹¤ë ¥ì„ ë³´ì—¬ì£¼ì§€!" }
    ];

    function appraise(isRetry) {
        if (playing) return;
        const item = items[Math.floor(Math.random() * items.length)];
        rewards.win = item.val;

        // ğŸ¯ ìš”ì²­í•˜ì‹  ë‚œì´ë„ ë°¸ëŸ°ìŠ¤ (1ì½”ì¸ ë¹ ë¦„ìƒí–¥, 5ì½”ì¸ íƒ€ì´íŠ¸ìƒí–¥)
        const speeds = { 1: 0.65, 2: 0.55, 3: 0.45, 4: 0.35, 5: 0.28 };
        currentSpeed = speeds[rewards.win];

        document.getElementById('item-area').style.display = 'block';
        document.getElementById('item-icon').src = item.img;
        document.getElementById('item-name').innerText = item.name;
        document.getElementById('dialogue').innerText = isRetry ? `"ê°„ ë³´ì§€ ë§ê³  ì´ê±¸ë¡œ ê°ˆ ê±´ê°€?"` : `"${item.msg}"`;
        document.getElementById('bet-details').innerText = `ì„±ê³µ: ${rewards.win} COINS / ì‹¤íŒ¨: 1 COIN`;
        
        document.getElementById('main-btn').innerText = "ì•¼ë°”ìœ„ ì‹œì‘";
        document.getElementById('main-btn').onclick = startShuffle;
        document.getElementById('re-appraise-btn').style.display = 'inline-block';
    }

    function startShuffle() {
        playing = true; finished = false;
        document.getElementById('main-btn').disabled = true;
        document.getElementById('re-appraise-btn').disabled = true;
        const hand = document.getElementById('dealer-hand');

        coinPos = Math.floor(Math.random() * 3);
        document.querySelectorAll('.coin-stack').forEach(s => s.classList.remove('visible'));
        document.querySelectorAll('.cup-slot').forEach(s => s.classList.remove('lifted'));

        setTimeout(() => {
            document.getElementById(`slot-${coinPos}`).classList.add('lifted');
            document.getElementById(`coins-${coinPos}`).classList.add('visible');
            
            setTimeout(() => {
                document.getElementById(`slot-${coinPos}`).classList.remove('lifted');
                document.getElementById(`coins-${coinPos}`).classList.remove('visible');
                hand.style.opacity = "1";
                performShuffle(0);
            }, 800);
        }, 400);
    }

    function performShuffle(count) {
        const hand = document.getElementById('dealer-hand');
        if (count >= 12) {
            hand.style.opacity = "0";
            playing = false;
            document.getElementById('dialogue').innerText = "ì, ì–´ëŠ ì»µì— ë“¤ì—ˆë‚˜?";
            return;
        }

        let a = Math.floor(Math.random() * 3);
        let b = Math.floor(Math.random() * 3);
        while(a === b) b = Math.floor(Math.random() * 3);

        const slotA = document.getElementById(`slot-${a}`);
        const slotB = document.getElementById(`slot-${b}`);
        
        slotA.style.transition = `left ${currentSpeed}s ease-in-out`;
        slotB.style.transition = `left ${currentSpeed}s ease-in-out`;
        hand.style.transition = `all ${currentSpeed}s ease-in-out`;
        
        hand.style.left = slotA.style.left;
        hand.style.top = "40px";

        setTimeout(() => {
            const tempLeft = slotA.style.left;
            slotA.style.left = slotB.style.left;
            slotB.style.left = tempLeft;
            hand.style.left = slotB.style.left; 

            if (coinPos === a) coinPos = b;
            else if (coinPos === b) coinPos = a;

            setTimeout(() => performShuffle(count + 1), currentSpeed * 1100);
        }, currentSpeed * 150);
    }

    function select(id) {
        if (playing || finished) return;
        finished = true;
        document.getElementById(`slot-${id}`).classList.add('lifted');
        
        if (id === coinPos) {
            document.getElementById(`coins-${id}`).classList.add('visible');
            coins += rewards.win;
            document.getElementById('dialogue').innerText = `"ì •í™•í•´! ${rewards.win}ì½”ì¸ ê°€ì ¸ê°€ê²Œ."`;
        } else {
            coins += 1;
            document.getElementById('dialogue').innerText = `"í‹€ë ¸ì–´. ì—­ì‹œ ì§í‰ì´ì—ˆêµ°."`;
            setTimeout(() => {
                document.getElementById(`slot-${coinPos}`).classList.add('lifted');
                document.getElementById(`coins-${coinPos}`).classList.add('visible');
            }, 500);
        }
        document.getElementById('balance').innerText = `${coins} COINS`;
        document.getElementById('main-btn').disabled = false;
        document.getElementById('main-btn').innerText = "ë¬¼ê±´ êº¼ë‚´ê¸°";
        document.getElementById('main-btn').onclick = () => appraise(false);
        document.getElementById('re-appraise-btn').disabled = false;
        document.getElementById('re-appraise-btn').style.display = 'none';
        document.getElementById('item-area').style.display = 'none';
    }
</script>
</body>
</html>
