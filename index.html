<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Black Market Pawn Shop</title>
    <style>
        :root { 
            --gold: #ffd700; --legendary: #ff8000; --epic: #a335ee; 
            --rare: #0070dd; --uncommon: #1eff00; --common: #9d9d9d; 
        }
        * { image-rendering: pixelated; box-sizing: border-box; font-family: 'Malgun Gothic', sans-serif; }
        
        body {
            margin: 0; height: 100vh;
            background: #0a0a0b url('https://github.com/bagjueun307/-/blob/main/%EC%A0%84%EC%B2%B4.png?raw=true') no-repeat center center;
            background-size: cover; display: flex; flex-direction: column; align-items: center; overflow: hidden;
        }

        /* [디자인] 반투명 UI 및 가독성 강화 */
        .ui-container {
            position: absolute; top: 40px; width: 620px;
            background: rgba(253, 253, 253, 0.85); 
            backdrop-filter: blur(10px);
            border: 6px solid #222; padding: 25px; color: #111;
            box-shadow: 20px 20px 0px rgba(0,0,0,0.5); z-index: 100;
            border-radius: 10px;
        }

        .balance-badge {
            position: absolute; top: -25px; right: -25px;
            background: #222; color: var(--gold); padding: 12px 20px;
            border: 4px solid var(--gold); font-size: 26px; font-weight: 900;
            transform: rotate(3deg); box-shadow: 5px 5px 0px rgba(0,0,0,0.3);
        }

        #dialogue { font-size: 22px; font-weight: 700; min-height: 65px; display: flex; align-items: center; }

        /* [핵심] 한글 등급 및 별점 표시창 */
        #item-info { 
            margin-top: 15px; padding: 20px; background: rgba(0, 0, 0, 0.9); color: white;
            border: 4px solid #444; display: none; text-align: center; border-radius: 8px;
        }
        
        .tier-korean { font-size: 48px; font-weight: 900; margin-bottom: 5px; display: block; }
        .star-rating { font-size: 28px; color: var(--gold); margin-bottom: 15px; letter-spacing: 5px; }

        .item-detail { font-size: 18px; color: #bbb; margin-bottom: 5px; }
        .value-text { font-size: 24px; font-weight: bold; color: var(--gold); }

        .btn-group { margin-top: 20px; display: flex; gap: 15px; }
        button { flex: 1; padding: 15px; border: 4px solid #111; cursor: pointer; font-size: 20px; font-weight: bold; border-radius: 5px; }
        .btn-accept { background: #222; color: #fff; }

        /* 야바위 구역 */
        .game-zone { 
            position: absolute; bottom: 8%; width: 1000px; height: 450px; 
            display: flex; justify-content: center;
        }

        .cup {
            position: absolute; bottom: 0; width: 320px; height: 380px;
            background: url('https://github.com/bagjueun307/-/blob/main/%EC%BB%B5%20%EC%97%8E%EC%9D%80%20%ED%98%95%ED%83%9C%20%EC%9D%B4%EB%AF%B8%EC%A7%80.png?raw=true') no-repeat center center;
            background-size: contain; 
            transition: left 0.35s ease-in-out, transform 0.4s ease; 
            cursor: pointer; z-index: 10;
        }

        .cup.lifted {
            background-image: url('https://github.com/bagjueun307/-/blob/main/%EC%9C%84%EB%A1%9C%20%ED%96%A5%ED%95%9C%20%EC%BB%B5%20%EC%9D%B4%EB%AF%B8%EC%A7%80.png?raw=true');
            transform: translateY(-220px);
        }

        .coin-stack { 
            position: absolute; bottom: 30px; 
            width: 280px; height: 280px; display: none; justify-content: center; z-index: 5;
            transition: left 0.35s ease-in-out;
        }
        .coin-stack.visible { display: flex; }
        
        .pixel-coin {
            width: 260px; height: 260px;
            background: url('https://github.com/bagjueun307/-/blob/main/%EC%BD%94%EC%9D%B8%20%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EC%A0%95%EC%B8%A1%EB%A9%B4.png?raw=true') no-repeat center center;
            background-size: contain;
        }
    </style>
</head>
<body>

    <div class="ui-container">
        <div class="balance-badge" id="balance-display">보유 코인: 0</div>
        <div style="font-size: 12px; color: #444; border-bottom: 1px solid #aaa; margin-bottom: 10px; font-weight: bold; letter-spacing: 1px;">암시장 물건 판독서</div>
        <div id="dialogue">"어이, 물건 좀 꺼내보라고. 가치에 따라 판돈이 결정되니까."</div>
        
        <div id="item-info">
            <div id="tier-kor" class="tier-korean">전설 등급</div>
            <div id="stars" class="star-rating">★★★★★</div>
            <div class="item-detail">감정 물건: <span id="item-name"></span></div>
            <div class="value-text">예상 수익: <span id="item-val"></span> 코인</div>
        </div>

        <div class="btn-group">
            <button id="btn-main" class="btn-accept" onclick="startAppraisal()">물건 꺼내기</button>
        </div>
    </div>

    <div class="game-zone">
        <div id="slot-0" class="cup" style="left: 0px;" onclick="select(0)"></div>
        <div id="slot-1" class="cup" style="left: 340px;" onclick="select(1)"></div>
        <div id="slot-2" class="cup" style="left: 680px;" onclick="select(2)"></div>
        
        <div id="stack-0" class="coin-stack" style="left: 0px;"><div class="pixel-coin"></div></div>
        <div id="stack-1" class="coin-stack" style="left: 340px;"><div class="pixel-coin"></div></div>
        <div id="stack-2" class="coin-stack" style="left: 680px;"><div class="pixel-coin"></div></div>
    </div>

<script>
    let wallet = 0; let playing = false; let finished = true; let coinPos = 1; let currentVal = 0;

    // [변경] 한글 등급명과 별점 매핑 (최소 1개 ~ 최대 5개)
    const tiers = {
        LEGENDARY: { kor: "전설 등급", stars: "★★★★★", color: "#ff8000", value: 10, msg: "세상에... 이건 전설의 보물이잖아!" },
        EPIC:      { kor: "에픽 등급", stars: "★★★★☆", color: "#a335ee", value: 7, msg: "오호, 암시장에서나 보던 귀한 물건이군." },
        RARE:      { kor: "희귀 등급", stars: "★★★☆☆", color: "#0070dd", value: 5, msg: "제법 돈이 되겠어. 희귀한 물건이야." },
        UNCOMMON:  { kor: "상급 등급", stars: "★★☆☆☆", color: "#1eff00", value: 3, msg: "나쁘지 않네. 쓸만한 물건이야." },
        COMMON:    { kor: "일반 등급", stars: "★☆☆☆☆", color: "#9d9d9d", value: 1, msg: "흥, 어디서나 볼 수 있는 흔한 장물이군." }
    };

    const itemList = ["낡은 장부", "녹슨 메달", "누군가의 사진", "수상한 병", "먼지 쌓인 반지"];

    function startAppraisal() {
        if(playing) return;
        const diag = document.getElementById('dialogue');
        document.getElementById('item-info').style.display = 'none';
        
        const thoughts = ["오.. 이게 뭐지...?", "흠.... 이거 본 거 같기도 하고..", "어디 보자.. 돋보기가 어디 있더라..", "아! 알겠다!"];
        let i = 0;
        const thinkingInterval = setInterval(() => {
            if(i < thoughts.length) diag.innerText = thoughts[i++];
            else { clearInterval(thinkingInterval); finishAppraisal(); }
        }, 500);
    }

    function finishAppraisal() {
        const rand = Math.random();
        let tierKey = (rand < 0.05) ? "LEGENDARY" : (rand < 0.15) ? "EPIC" : (rand < 0.35) ? "RARE" : (rand < 0.65) ? "UNCOMMON" : "COMMON";
        const tier = tiers[tierKey];
        currentVal = tier.value;
        
        const info = document.getElementById('item-info');
        document.getElementById('tier-kor').innerText = tier.kor;
        document.getElementById('tier-kor').style.color = tier.color;
        document.getElementById('stars').innerText = tier.stars;
        
        document.getElementById('item-name').innerText = itemList[Math.floor(Math.random()*itemList.length)];
        document.getElementById('item-val').innerText = currentVal;
        info.style.display = 'block';
        
        document.getElementById('dialogue').innerText = `"${tier.msg}"`;
        const btn = document.getElementById('btn-main');
        btn.innerText = "야바위 수락 (도전)";
        btn.onclick = startShuffle;
    }

    function startShuffle() {
        playing = true; finished = false;
        document.querySelectorAll('.coin-stack').forEach(s => s.classList.remove('visible'));
        
        coinPos = Math.floor(Math.random()*3);
        document.getElementById(`slot-${coinPos}`).classList.add('lifted');
        document.getElementById(`stack-${coinPos}`).classList.add('visible');

        setTimeout(() => {
            document.getElementById(`slot-${coinPos}`).classList.remove('lifted');
            setTimeout(() => { 
                document.getElementById(`stack-${coinPos}`).classList.remove('visible');
                performShuffle(0, 15); // 15번 섞기
            }, 600);
        }, 1000);
    }

    function performShuffle(count, total) {
        if(count >= total) {
            playing = false;
            document.getElementById('dialogue').innerText = "자... 어디에 들었지? (컵을 클릭해!)";
            return;
        }

        let a = Math.floor(Math.random()*3);
        let b = Math.floor(Math.random()*3);
        while(a === b) b = Math.floor(Math.random()*3);

        const cupA = document.getElementById(`slot-${a}`);
        const cupB = document.getElementById(`slot-${b}`);
        const stackA = document.getElementById(`stack-${a}`);
        const stackB = document.getElementById(`stack-${b}`);

        const tempLeft = cupA.style.left;
        cupA.style.left = cupB.style.left;
        cupB.style.left = tempLeft;
        stackA.style.left = stackB.style.left;
        stackB.style.left = tempLeft;

        setTimeout(() => performShuffle(count + 1, total), 350);
    }

    function select(id) {
        if(playing || finished) return;
        finished = true;
        
        for(let i=0; i<3; i++) document.getElementById(`slot-${i}`).classList.add('lifted');
        document.getElementById(`stack-${coinPos}`).classList.add('visible');

        // 코인 위치 추적 로직 (컵의 위치를 확인하여 정답 체크)
        // 현재 선택한 id 컵의 left 값이 정답 stack의 left 값과 같은지 확인
        const selectedCupLeft = document.getElementById(`slot-${id}`).style.left;
        const answerStackLeft = document.getElementById(`stack-${coinPos}`).style.left;

        if(selectedCupLeft === answerStackLeft) {
            wallet += currentVal;
            document.getElementById('dialogue').innerText = "호오... 눈썰미가 보통이 아니구만! 여기 코인 받게.";
        } else {
            document.getElementById('dialogue').innerText = "땡! 아쉽구만. 다음번에 다시 오게나.";
        }

        document.getElementById('balance-display').innerText = `보유 코인: ${wallet}`;
        setTimeout(() => {
            document.getElementById('btn-main').innerText = "다른 물건 가져오기";
            document.getElementById('btn-main').onclick = startAppraisal;
        }, 2000);
    }
</script>
</body>
</html>
